# 线程间通信

**技术要点**
- 使用wait/notify实现线程间的通信
- 生产者/消费者模式的实现
- 方法join的使用
- ThreadLocal类的使用

## 等待/通知机制

1. **等待通知机制的实现**
- What is wait()
wait()方法是Object类的方法，将当前线程置入“预执行队列”中，并且在wait()所在的代码行处停止执行，知道接到通知或被中断为止。在调用wait()之前，线程必须获得该对象的对象级别锁，即，只能在同步方法或者同步块中调用wait()方法。执行wait()方法后，当前线程释放锁。如果在wait()时，没有持有适当的锁，则抛出IllegalMonitorStateException。
- what is notify()
notify()方法也要在同步方法或同步块中调用，即，在调用前必须取得该对象的对象级别锁，如果没有持有适当的锁，也会抛出IllegalMonitorStateException。该方法用来通知那些可能等待该对象的对象锁的其他线程，如果有多个线程等待，则由线程规划器随机挑出其中一个呈wait状态的线程，对其发出notify通知。在执行notify()方法后，线程并不会马上释放该对象锁，呈wait状态的线程也并不会马上获取该对象锁，要等到执行notify()方法的线程将程序执行完，也就是退出synchronized代码后，当前线程才会释放锁，而呈wait状态的线程才可以取得该对象锁。
> 用一句话总结：wait使线程停止运行，notify使停止的线程继续运行

